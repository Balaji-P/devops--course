<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Prerequisites | vfarcic.github.io</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Prerequisites" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/devops25/REQS.html" />
<meta property="og:url" content="http://localhost:4000/devops25/REQS.html" />
<meta property="og:site_name" content="vfarcic.github.io" />
<script type="application/ld+json">
{"url":"http://localhost:4000/devops25/REQS.html","@type":"WebPage","headline":"Prerequisites","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=d7b0fccce7a840960ab2c608e690e524c171b2d9">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">vfarcic.github.io</a></h1>
      

      <h2 id="prerequisites">Prerequisites</h2>

<p>The training assumes that you already know how to operate a Kubernetes cluster so we won’t go into details how to create one nor we’ll explore Pods, Deployments, StatefulSets, and other commonly used Kubernetes resources. If that assumption is not correct, you might want to read <a href="https://amzn.to/2GvzDjy">The DevOps 2.3 Toolkit: Kubernetes</a> first.</p>

<p>Apart from assumptions based on knowledge, there are some technical requirements as well. If you are a <strong>Windows user</strong>, please run all the examples from <strong>Git Bash</strong>. It will allow you to run the same commands as MacOS and Linux users do through their terminals. Git Bash is set up during <a href="https://git-scm.com/download/win">Git</a> installation. If you don’t have it already, please re-run Git setup.</p>

<p>Since we’ll use a Kubernetes cluster, we’ll need <strong><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a></strong>. Most of the applications we’ll run inside the cluster will be installed using <strong><a href="https://helm.sh/">Helm</a></strong>, so please make sure that you have the client installed as well. Finally, install <strong><a href="https://stedolan.github.io/jq/">jq</a></strong> as well. It’s a tool that helps us format and filter JSON output.</p>

<p>Finally, we’ll need a Kubernetes cluster. All the examples are tested using <strong>Google Kubernetes Engine (GKE)</strong>, <strong>Amazon Elastic Container Service for Kubernetes (EKS)</strong>, and <strong>Azure Kubernetes Service (AKS)</strong>.</p>

<p>If you’re unsure which Kubernetes flavor to select, choose GKE. It is currently the most advanced and feature-rich managed Kubernetes on the market. On the other hand, if you’re already used to EKS or AKS, they are, more or less, OK as well.</p>

<p>The commands specific for each of the three Cloud providers are below. Please register on <a href="http://slack.devops20toolkit.com/">DevOps20</a> Slack channel and contact me directly if you have any issue creating your cluster. My Slack username is <strong>vfarcic</strong>.</p>

<h2 id="prerequisites-for-aws-eks">Prerequisites for AWS EKS</h2>

<p>We’ll need an up-and-running EKS cluster before the training. Feel free to reuse an existing cluster if you already have it or to create a new one for this training. You can use the commands that follow as inspiration.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Make sure that you're using eksctl v0.1.5+.</span>

<span class="c"># Follow the instructions from https://github.com/weaveworks/eksctl to intall eksctl.</span>

<span class="nb">export </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=[</span>...] <span class="c"># Replace [...] with AWS access key ID</span>

<span class="nb">export </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=[</span>...] <span class="c"># Replace [...] with AWS secret access key</span>

<span class="nb">export </span><span class="nv">AWS_DEFAULT_REGION</span><span class="o">=</span>us-west-2

<span class="nb">export </span><span class="nv">NAME</span><span class="o">=</span>devops25

mkdir <span class="nt">-p</span> cluster

eksctl create cluster <span class="se">\</span>
    <span class="nt">-n</span> <span class="nv">$NAME</span> <span class="se">\</span>
    <span class="nt">-r</span> <span class="nv">$AWS_DEFAULT_REGION</span> <span class="se">\</span>
    <span class="nt">--kubeconfig</span> cluster/kubecfg-eks <span class="se">\</span>
    <span class="nt">--node-type</span> t2.small <span class="se">\</span>
    <span class="nt">--nodes</span> 3 <span class="se">\</span>
    <span class="nt">--nodes-max</span> 9 <span class="se">\</span>
    <span class="nt">--nodes-min</span> 3

<span class="nb">export </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$PWD</span>/cluster/kubecfg-eks
</code></pre></div></div>

<h2 id="prerequisites-for-gcp-gke">Prerequisites for GCP GKE</h2>

<p>We’ll need an up-and-running GKE cluster before the training. Feel free to reuse an existing cluster if you already have it or to create a new one for this training. You can use the commands that follow as inspiration.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Follow the instructions from https://cloud.google.com/sdk/install to install gcloud.</span>

gcloud auth login

<span class="nv">REGION</span><span class="o">=</span>us-east1

<span class="nv">MACHINE_TYPE</span><span class="o">=</span>n1-standard-1

gcloud container clusters <span class="se">\</span>
    create devops25 <span class="se">\</span>
    <span class="nt">--region</span> <span class="nv">$REGION</span> <span class="se">\</span>
    <span class="nt">--machine-type</span> <span class="nv">$MACHINE_TYPE</span> <span class="se">\</span>
    <span class="nt">--enable-autoscaling</span> <span class="se">\</span>
    <span class="nt">--num-nodes</span> 1 <span class="se">\</span>
    <span class="nt">--max-nodes</span> 3 <span class="se">\</span>
    <span class="nt">--min-nodes</span> 1

kubectl create clusterrolebinding <span class="se">\</span>
    cluster-admin-binding <span class="se">\</span>
    <span class="nt">--clusterrole</span> cluster-admin <span class="se">\</span>
    <span class="nt">--user</span> <span class="k">$(</span>gcloud config get-value account<span class="k">)</span>
</code></pre></div></div>

<h2 id="prerequisites-for-azure-aks">Prerequisites for Azure AKS</h2>

<p>We’ll need an up-and-running AKS cluster before the training. Feel free to reuse an existing cluster if you already have it or to create a new one for this training. You can use the commands that follow as inspiration.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az login

az provider register <span class="nt">-n</span> Microsoft.Network

az provider register <span class="nt">-n</span> Microsoft.Storage

az provider register <span class="nt">-n</span> Microsoft.Compute

az provider register <span class="nt">-n</span> Microsoft.ContainerService

az group create <span class="se">\</span>
    <span class="nt">--name</span> devops25-group <span class="se">\</span>
    <span class="nt">--location</span> eastus

<span class="nb">export </span><span class="nv">VM_SIZE</span><span class="o">=</span>Standard_B2s

<span class="nb">export </span><span class="nv">NAME</span><span class="o">=</span>devops25

az aks create <span class="se">\</span>
    <span class="nt">--resource-group</span> <span class="nv">$NAME</span><span class="nt">-group</span> <span class="se">\</span>
    <span class="nt">--name</span> <span class="nv">$NAME</span><span class="nt">-cluster</span> <span class="se">\</span>
    <span class="nt">--node-count</span> 3 <span class="se">\</span>
    <span class="nt">--node-vm-size</span> <span class="nv">$VM_SIZE</span> <span class="se">\</span>
    <span class="nt">--generate-ssh-keys</span> <span class="se">\</span>
    <span class="nt">--kubernetes-version</span> 1.11.5

rm <span class="nt">-f</span> <span class="nv">$PWD</span>/cluster/kubecfg-aks

az aks get-credentials <span class="se">\</span>
    <span class="nt">--resource-group</span> devops25-group <span class="se">\</span>
    <span class="nt">--name</span> devops25-cluster <span class="se">\</span>
    <span class="nt">-f</span> cluster/kubecfg-aks

<span class="nb">export </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$PWD</span>/cluster/kubecfg-aks
</code></pre></div></div>

<h2 id="something">Something</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create <span class="se">\</span>
    <span class="nt">-f</span> https://raw.githubusercontent.com/vfarcic/k8s-specs/master/helm/tiller-rbac.yml <span class="se">\</span>
    <span class="nt">--record</span> <span class="nt">--save-config</span>

helm init <span class="nt">--service-account</span> tiller
</code></pre></div></div>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="https://github.com/vfarcic/vfarcic.github.io/edit/gh-pages/devops25/REQS.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
